import datetime as dt

import numpy as np
import pytest


@pytest.fixture
def single_satellite_single_date_data():
    tle = (
        "1 41557U 16033B   20345.20030338  .00003290  00000-0  12071-3 0  9996",
        "2 41557  97.3998  74.3002 0013100 179.2679 265.4184 15.28602096252616",
    )
    epoch = dt.datetime(2020, 12, 11, 12, 0, 0)
    expected_r = (1902.017829907682, 5514.393345746716, 3616.812182638985)
    expected_v = (-0.20735506463872982, -4.140722397852882, 6.391434915103069)

    return tle, epoch, expected_r, expected_v


@pytest.fixture
def single_satellite_multiple_dates_data_medium():
    tle = (
        "1 41557U 16033B   20345.20030338  .00003290  00000-0  12071-3 0  9996",
        "2 41557  97.3998  74.3002 0013100 179.2679 265.4184 15.28602096252616",
    )
    epochs = (
        [dt.datetime(2020, 12, 11, 12, 0, minute) for minute in range(60)]
        + [dt.datetime(2020, 12, 11, 12, hour, 0) for hour in range(1, 24)]
        + [dt.datetime(2020, 12, day, 0, 0, 0) for day in range(13, 31)]
    )
    expected_rs = np.array(
        [
            [1902.017829907682, 5514.393345746716, 3616.812182638985],
            [1901.8093075774054, 5510.249236148863, 3623.2013872471553],
            [1901.5984419218719, 5506.098337045109, 3629.5861149700195],
            [1901.3852332004753, 5501.940653549183, 3635.966357916904],
            [1901.1696816754716, 5497.776190782482, 3642.3421082038126],
            [1900.9517876120392, 5493.604953875294, 3648.7133579515153],
            [1900.7315512782295, 5489.426947965874, 3655.0800992870154],
            [1900.5089729450137, 5485.242178201267, 3661.442324342229],
            [1900.2840528862307, 5481.05064973635, 3667.8000252555144],
            [1900.056791378657, 5476.8523677352205, 3674.1531941694966],
            [1899.8271887019173, 5472.647337369357, 3680.5018232339003],
            [1899.5952451385374, 5468.435563818789, 3686.845904603753],
            [1899.3609609739983, 5464.2170522729675, 3693.1854304380963],
            [1899.124336496578, 5459.991807927961, 3699.520392904192],
            [1898.8853719975143, 5455.759835989316, 3705.850784173194],
            [1898.644067770927, 5451.52114167072, 3712.176596422246],
            [1898.4004241138148, 5447.275730193938, 3718.4978218344563],
            [1898.1544413260633, 5443.0236067889355, 3724.814452598815],
            [1897.9061197104822, 5438.764776694615, 3731.126480909019],
            [1897.655459572739, 5434.499245157525, 3737.4338989654525],
            [1897.402461221401, 5430.227017432625, 3743.736698974014],
            [1897.1471249679307, 5425.948098783346, 3750.034873146041],
            [1896.889451126686, 5421.662494481394, 3756.328413698591],
            [1896.6294400148956, 5417.370209806541, 3762.617312854761],
            [1896.3670919526962, 5413.071250046911, 3768.9015628432703],
            [1896.102407263094, 5408.765620498868, 3775.1811558985887],
            [1895.8353862719882, 5404.453326466822, 3781.4560842612686],
            [1895.5660293081946, 5400.134373264079, 3787.7263401766872],
            [1895.2943367033772, 5395.808766211505, 3793.99191589696],
            [1895.0203087921052, 5391.476510638409, 3800.252803679711],
            [1894.7439459118273, 5387.137611882339, 3806.5089957883256],
            [1894.465248402876, 5382.7920752889095, 3812.760484492223],
            [1894.1842166084837, 5378.439906212306, 3819.007262066115],
            [1893.9008508747502, 5374.081110014442, 3825.2493207912335],
            [1893.6151515506695, 5369.71569206577, 3831.4866529541405],
            [1893.3271189881357, 5365.343657745023, 3837.719250847141],
            [1893.0367535418834, 5360.965012438581, 3843.947106769141],
            [1892.7440555695518, 5356.579761541288, 3850.1702130245085],
            [1892.4490254316827, 5352.18791045641, 3856.3885619231332],
            [1892.1516634916736, 5347.789464595027, 3862.602145781272],
            [1891.8519701158036, 5343.384429376349, 3868.8109569211306],
            [1891.5499456732557, 5338.972810228081, 3875.014987670313],
            [1891.2455905360723, 5334.554612585735, 3881.2142303628157],
            [1890.9389050791776, 5330.129841893038, 3887.4086773384497],
            [1890.629889680376, 5325.698503601754, 3893.598320943083],
            [1890.3185447203566, 5321.26060317197, 3899.783153528236],
            [1890.0048705827012, 5316.816146071994, 3905.9631674512307],
            [1889.688867653821, 5312.3651377775805, 3912.1383550763057],
            [1889.3705363230576, 5307.9075837733335, 3918.308708772575],
            [1889.0498769826013, 5303.443489551519, 3924.474220915769],
            [1888.7268900275135, 5298.972860612466, 3930.634883887622],
            [1888.401575855758, 5294.49570246494, 3936.790690075387],
            [1888.0739348681482, 5290.012020625405, 3942.9416318728204],
            [1887.7439674683844, 5285.521820618521, 3949.0877016795434],
            [1887.4116740630266, 5281.025107976863, 3955.22889190137],
            [1887.0770550615455, 5276.521888241535, 3961.3651949495284],
            [1886.7401108762172, 5272.0121669607415, 3967.496603242561],
            [1886.4008419222878, 5267.495949692107, 3973.6231092031817],
            [1886.0592486177588, 5262.973241999665, 3979.7447052623806],
            [1885.7153313836, 5258.4440494567425, 3985.861383855509],
            [1885.369090643603, 5253.908377644081, 3991.973137424776],
            [1860.3603640147082, 4970.1267905272825, 4349.383415363615],
            [1827.102588133785, 4664.307045740094, 4687.453843391724],
            [1785.7433262992506, 4337.805437782361, 5004.681385182894],
            [1736.4660700622821, 3992.0699578704207, 5299.655741261225],
            [1679.4893854976624, 3628.6337767005166, 5571.065506015345],
            [1615.0659090812176, 3249.10838183396, 5817.703861280114],
            [1543.4811999925507, 2855.1764049577555, 6038.473789594685],
            [1465.0524559336893, 2448.584173713401, 6232.392793374764],
            [1380.1270996925969, 2031.134021894651, 6398.5971090015855],
            [1289.0812437103511, 1604.6763907249965, 6536.345407165737],
            [1192.3180398482507, 1171.1017526964185, 6645.021972714883],
            [1090.2659214272355, 732.3323882146238, 6724.139358721448],
            [983.3767444549384, 290.3140441446609, 6773.340510540563],
            [872.1238347910896, -152.9924976389732, 6792.40035631694],
            [756.9999478614718, -595.6199143291749, 6781.226860779242],
            [638.5151474404398, -1035.6028719442797, 6739.8615393158825],
            [517.194610004186, -1470.9865638939411, 6668.479429350113],
            [393.57636122748687, -1899.8352311900098, 6567.388516022642],
            [268.2089513807238, -2320.2406364482413, 6437.028609257369],
            [141.64907667169902, -2730.3304628225246, 6277.969669529208],
            [14.459153985080393, -3128.2766076844464, 6090.909580174228],
            [-112.79514301346988, -3512.3033393081932, 5876.671364967075],
            [1555.576628119171, 6689.429612006905, 160.09016034457989],
            [580.5720323577907, -1444.8182353349043, 6667.6115052988225],
            [-1523.0562655578067, -6235.994352332637, -2408.6722984536445],
            [-159.743323427436, 3528.357106620524, -5895.102966680752],
            [1378.1198833334083, 5145.436781539436, 4321.002825847646],
            [-148.34346917990604, -5221.600122475786, 4425.187458290727],
            [-1180.4514123324327, -3406.527533492021, -5842.385406362396],
            [338.9626491493065, 6388.199018041551, -2510.2259806490365],
            [982.7093176168127, 1336.5066224728498, 6642.635079905863],
            [-445.9248110686201, -6835.808078514031, 221.1680616924222],
            [-828.6455146430822, 966.0791363273898, -6753.584306713813],
            [487.47999558044654, 6544.617932203937, 2004.4327747089353],
            [730.3590499648018, -3138.9862999378283, 6036.5345976049475],
            [-534.7030691024943, -5467.650004744615, -4116.379968715104],
            [-695.1284954916638, 4984.964050112834, -4680.430738925479],
            [603.287147471104, 3810.650836063182, 5657.720565798082],
            [676.4712500364693, -6265.2887066041585, 2687.7142139210496],
            [-747.7474840010815, -1661.5652916857762, -6626.684507277654],
        ]
    )
    expected_vs = np.array(
        [
            [-0.2073550646387298, -4.140722397852882, 6.391434915103069],
            [-0.2096985197227052, -4.147514435605311, 6.38696195708428],
            [-0.2120417168437132, -4.154301364166556, 6.3824811063454865],
            [-0.21438465310437, -4.161083175142957, 6.37799236843962],
            [-0.2167273256080704, -4.167859860148546, 6.373495748928588],
            [-0.2190697314582986, -4.174631410803029, 6.368991253384616],
            [-0.2214118677591449, -4.181397818733315, 6.364478887389197],
            [-0.2237537316148448, -4.188159075572147, 6.3599586565340465],
            [-0.2260953201303225, -4.194915172959697, 6.355430566420001],
            [-0.2284366304104022, -4.201666102541273, 6.350894622658565],
            [-0.230777659560845, -4.208411855970331, 6.346350830869909],
            [-0.2331184046876895, -4.215152424906547, 6.341799196684123],
            [-0.2354588628967786, -4.2218878010144705, 6.337239725742165],
            [-0.2377990312953039, -4.228617975967973, 6.332672423692828],
            [-0.2401389069902221, -4.235342941445674, 6.328097296195846],
            [-0.2424784870890095, -4.242062689133129, 6.323514348920403],
            [-0.2448177686996754, -4.248777210722855, 6.318923587545126],
            [-0.2471567489307131, -4.255486497914194, 6.314325017758162],
            [-0.2494954248906751, -4.262190542412103, 6.309718645258018],
            [-0.2518337936889068, -4.268889335929229, 6.305104475752124],
            [-0.2541718524351056, -4.275582870184684, 6.300482514957695],
            [-0.256509598239298, -4.282271136903951, 6.29585276860177],
            [-0.2588470282119419, -4.288954127819188, 6.291215242421014],
            [-0.2611841394640487, -4.295631834669566, 6.286569942161479],
            [-0.2635209291070231, -4.3023042492008265, 6.281916873578925],
            [-0.265857394252715, -4.30897136316542, 6.277256042438696],
            [-0.2681935320135406, -4.315633168322853, 6.272587454515494],
            [-0.2705293395020175, -4.322289656438352, 6.267911115594314],
            [-0.2728648138314709, -4.328940819284907, 6.2632270314690075],
            [-0.2751999521155856, -4.335586648641951, 6.2585352079432],
            [-0.2775347514684905, -4.342227136295636, 6.25383565083011],
            [-0.2798692090048668, -4.348862274039118, 6.249128365952336],
            [-0.2822033218396666, -4.355492053671778, 6.244413359142413],
            [-0.2845370870885757, -4.362116467000512, 6.239690636241896],
            [-0.2868705018675685, -4.3687355058384885, 6.234960203102241],
            [-0.2892035632930586, -4.375349162005552, 6.230222065584509],
            [-0.2915362684822215, -4.381957427329174, 6.225476229558707],
            [-0.293868614552574, -4.388560293643217, 6.220722700904647],
            [-0.2962005986219851, -4.395157752788007, 6.215961485511906],
            [-0.2985322178090071, -4.401749796611226, 6.211192589279184],
            [-0.3008634692327058, -4.408336416967473, 6.206416018114613],
            [-0.3031943500124629, -4.414917605717685, 6.201631777936185],
            [-0.3055248572683437, -4.421493354730167, 6.196839874670979],
            [-0.3078549881208841, -4.428063655880017, 6.192040314255626],
            [-0.3101847396911808, -4.4346285010493425, 6.18723310263609],
            [-0.3125141091007347, -4.441187882126871, 6.182418245768007],
            [-0.314843093471518, -4.447741791008075, 6.177595749616556],
            [-0.3171716899263782, -4.454290219596361, 6.172765620155591],
            [-0.3194998955882855, -4.460833159800929, 6.167927863369228],
            [-0.3218277075809772, -4.46737060353859, 6.163082485250503],
            [-0.3241551230287344, -4.473902542733123, 6.158229491801822],
            [-0.326482139056193, -4.480428969314776, 6.153368889035366],
            [-0.3288087527887225, -4.486949875221291, 6.148500682972296],
            [-0.3311349613521739, -4.493465252397231, 6.143624879643273],
            [-0.3334607618730176, -4.499975092794339, 6.138741485088183],
            [-0.3357861514780387, -4.506479388370698, 6.1338505053567625],
            [-0.3381111272950615, -4.512978131092746, 6.128951946507087],
            [-0.340435686451753, -4.519471312931965, 6.124045814608065],
            [-0.3427598260771864, -4.525958925869203, 6.119132115736172],
            [-0.3450835433003527, -4.532440961890534, 6.114210855978575],
            [-0.3474068352511085, -4.538917412989925, 6.109282041431131],
            [-0.4859179223569589, -4.916985557122564, 5.7999639312986195],
            [-0.6222730120575873, -5.273247502383786, 5.464858846089748],
            [-0.75586706932246, -5.6061228229650615, 5.105458587632392],
            [-0.8861079998771406, -5.914136629448147, 4.723361304896389],
            [-1.0124192096869649, -6.195925614885237, 4.32026393330377],
            [-1.1342420539667804, -6.4502435119306, 3.8979543258959164],
            [-1.2510381701383082, -6.675965967603209, 3.4583031309656986],
            [-1.3622916914520262, -6.872094848169788, 3.0032554649613568],
            [-1.4675113400082147, -7.037761991012112, 2.5348224227943206],
            [-1.5662323995641427, -7.172232423044094, 2.0550724605242365],
            [-1.6580185697550913, -7.274907066258617, 1.5661226780726738],
            [-1.7424637041349924, -7.345324950324131, 1.0701300225377668],
            [-1.8191934347406797, -7.383164949933702, 0.5692824261998276],
            [-1.8878666857061708, -7.38824706101544, 0.0657898877408968],
            [-1.9481770778193883, -7.360533225179964, -0.4381244991417098],
            [-1.9998542248694826, -7.300127706207726, -0.9402335684331059],
            [-2.042664921243011, -7.207277016305739, -1.4383151557770972],
            [-2.076414218573187, -7.082369383650207, -1.930161223251664],
            [-2.100946387418187, -6.925933746764095, -2.4135870322443296],
            [-2.1161457580545555, -6.738638255921973, -2.8864403578731332],
            [-2.121937432622076, -6.521288257385855, -3.3466107329862713],
            [-2.118287859161693, -6.274823733168899, -3.792038703061413],
            [0.9125441136971254, -0.4036263758191757, 7.5486308279435335],
            [-1.729961033875925, -7.290729001501352, -1.4355610853568541],
            [-0.3916201544601054, 2.8167811063026003, -7.077962466427237],
            [1.6184297618406134, 6.396734535484474, 3.778738245362283],
            [-0.0080292479855039, -4.915065455539146, 5.825540099474531],
            [-1.4265859438109267, -4.8322204640145925, -5.7379636127176274],
            [0.2897642770579129, 6.539276361815458, -3.8844862764055033],
            [1.1963932991763286, 2.6864347770586763, 7.0191019613676255],
            [-0.4455836541568785, -7.456656235390363, 1.5538057203626578],
            [-0.9975397122714986, -0.1946639775439141, -7.5638573644429385],
            [0.5217555136151566, 7.515999697547012, 1.0052803968671364],
            [0.8577574094931962, -2.294384083965723, 7.2175594450779],
            [-0.5657934399594602, -6.785902068629772, -3.4546071716871123],
            [-0.7819445998604514, 4.594586638449409, -6.023200662213964],
            [0.6211293067030208, 5.230422410669326, 5.486381546483309],
            [0.7622805619711007, -6.3441491290521, 4.171792905923215],
            [-0.7421348156995247, -3.078366902016442, -6.9456623617471385],
            [-0.7414507861435826, 7.355580423966695, -1.7666135107468575],
        ]
    )

    return tle, epochs, expected_rs, expected_vs


@pytest.fixture
def single_satellite_multiple_dates_data_large():
    tle = (
        "1 41557U 16033B   20345.20030338  .00003290  00000-0  12071-3 0  9996",
        "2 41557  97.3998  74.3002 0013100 179.2679 265.4184 15.28602096252616",
    )
    epochs = (
        [dt.datetime(2020, 12, 11, 12, 0, minute) for minute in range(60)]
        + [dt.datetime(2020, 12, 11, 12, hour, 0) for hour in range(1, 24)]
        + [dt.datetime(2020, 12, day, 0, 0, 0) for day in range(13, 31)]
    ) * 100

    return tle, epochs, (len(epochs), 3)


@pytest.fixture
def multiple_satellites_multiple_dates_data_medium():
    tle = (
        "1 41557U 16033B   20345.20030338  .00003290  00000-0  12071-3 0  9996",
        "2 41557  97.3998  74.3002 0013100 179.2679 265.4184 15.28602096252616",
    )
    # TODO: Use different TLEs?
    tles = [tle] * 100
    epochs = (
        [dt.datetime(2020, 12, 11, 12, 0, minute) for minute in range(60)]
        + [dt.datetime(2020, 12, 11, 12, hour, 0) for hour in range(1, 24)]
        + [dt.datetime(2020, 12, day, 0, 0, 0) for day in range(13, 31)]
    )
    expected_rs = np.array(
        [
            [1902.017829907682, 5514.393345746716, 3616.812182638985],
            [1901.8093075774054, 5510.249236148863, 3623.2013872471553],
            [1901.5984419218719, 5506.098337045109, 3629.5861149700195],
            [1901.3852332004753, 5501.940653549183, 3635.966357916904],
            [1901.1696816754716, 5497.776190782482, 3642.3421082038126],
            [1900.9517876120392, 5493.604953875294, 3648.7133579515153],
            [1900.7315512782295, 5489.426947965874, 3655.0800992870154],
            [1900.5089729450137, 5485.242178201267, 3661.442324342229],
            [1900.2840528862307, 5481.05064973635, 3667.8000252555144],
            [1900.056791378657, 5476.8523677352205, 3674.1531941694966],
            [1899.8271887019173, 5472.647337369357, 3680.5018232339003],
            [1899.5952451385374, 5468.435563818789, 3686.845904603753],
            [1899.3609609739983, 5464.2170522729675, 3693.1854304380963],
            [1899.124336496578, 5459.991807927961, 3699.520392904192],
            [1898.8853719975143, 5455.759835989316, 3705.850784173194],
            [1898.644067770927, 5451.52114167072, 3712.176596422246],
            [1898.4004241138148, 5447.275730193938, 3718.4978218344563],
            [1898.1544413260633, 5443.0236067889355, 3724.814452598815],
            [1897.9061197104822, 5438.764776694615, 3731.126480909019],
            [1897.655459572739, 5434.499245157525, 3737.4338989654525],
            [1897.402461221401, 5430.227017432625, 3743.736698974014],
            [1897.1471249679307, 5425.948098783346, 3750.034873146041],
            [1896.889451126686, 5421.662494481394, 3756.328413698591],
            [1896.6294400148956, 5417.370209806541, 3762.617312854761],
            [1896.3670919526962, 5413.071250046911, 3768.9015628432703],
            [1896.102407263094, 5408.765620498868, 3775.1811558985887],
            [1895.8353862719882, 5404.453326466822, 3781.4560842612686],
            [1895.5660293081946, 5400.134373264079, 3787.7263401766872],
            [1895.2943367033772, 5395.808766211505, 3793.99191589696],
            [1895.0203087921052, 5391.476510638409, 3800.252803679711],
            [1894.7439459118273, 5387.137611882339, 3806.5089957883256],
            [1894.465248402876, 5382.7920752889095, 3812.760484492223],
            [1894.1842166084837, 5378.439906212306, 3819.007262066115],
            [1893.9008508747502, 5374.081110014442, 3825.2493207912335],
            [1893.6151515506695, 5369.71569206577, 3831.4866529541405],
            [1893.3271189881357, 5365.343657745023, 3837.719250847141],
            [1893.0367535418834, 5360.965012438581, 3843.947106769141],
            [1892.7440555695518, 5356.579761541288, 3850.1702130245085],
            [1892.4490254316827, 5352.18791045641, 3856.3885619231332],
            [1892.1516634916736, 5347.789464595027, 3862.602145781272],
            [1891.8519701158036, 5343.384429376349, 3868.8109569211306],
            [1891.5499456732557, 5338.972810228081, 3875.014987670313],
            [1891.2455905360723, 5334.554612585735, 3881.2142303628157],
            [1890.9389050791776, 5330.129841893038, 3887.4086773384497],
            [1890.629889680376, 5325.698503601754, 3893.598320943083],
            [1890.3185447203566, 5321.26060317197, 3899.783153528236],
            [1890.0048705827012, 5316.816146071994, 3905.9631674512307],
            [1889.688867653821, 5312.3651377775805, 3912.1383550763057],
            [1889.3705363230576, 5307.9075837733335, 3918.308708772575],
            [1889.0498769826013, 5303.443489551519, 3924.474220915769],
            [1888.7268900275135, 5298.972860612466, 3930.634883887622],
            [1888.401575855758, 5294.49570246494, 3936.790690075387],
            [1888.0739348681482, 5290.012020625405, 3942.9416318728204],
            [1887.7439674683844, 5285.521820618521, 3949.0877016795434],
            [1887.4116740630266, 5281.025107976863, 3955.22889190137],
            [1887.0770550615455, 5276.521888241535, 3961.3651949495284],
            [1886.7401108762172, 5272.0121669607415, 3967.496603242561],
            [1886.4008419222878, 5267.495949692107, 3973.6231092031817],
            [1886.0592486177588, 5262.973241999665, 3979.7447052623806],
            [1885.7153313836, 5258.4440494567425, 3985.861383855509],
            [1885.369090643603, 5253.908377644081, 3991.973137424776],
            [1860.3603640147082, 4970.1267905272825, 4349.383415363615],
            [1827.102588133785, 4664.307045740094, 4687.453843391724],
            [1785.7433262992506, 4337.805437782361, 5004.681385182894],
            [1736.4660700622821, 3992.0699578704207, 5299.655741261225],
            [1679.4893854976624, 3628.6337767005166, 5571.065506015345],
            [1615.0659090812176, 3249.10838183396, 5817.703861280114],
            [1543.4811999925507, 2855.1764049577555, 6038.473789594685],
            [1465.0524559336893, 2448.584173713401, 6232.392793374764],
            [1380.1270996925969, 2031.134021894651, 6398.5971090015855],
            [1289.0812437103511, 1604.6763907249965, 6536.345407165737],
            [1192.3180398482507, 1171.1017526964185, 6645.021972714883],
            [1090.2659214272355, 732.3323882146238, 6724.139358721448],
            [983.3767444549384, 290.3140441446609, 6773.340510540563],
            [872.1238347910896, -152.9924976389732, 6792.40035631694],
            [756.9999478614718, -595.6199143291749, 6781.226860779242],
            [638.5151474404398, -1035.6028719442797, 6739.8615393158825],
            [517.194610004186, -1470.9865638939411, 6668.479429350113],
            [393.57636122748687, -1899.8352311900098, 6567.388516022642],
            [268.2089513807238, -2320.2406364482413, 6437.028609257369],
            [141.64907667169902, -2730.3304628225246, 6277.969669529208],
            [14.459153985080393, -3128.2766076844464, 6090.909580174228],
            [-112.79514301346988, -3512.3033393081932, 5876.671364967075],
            [1555.576628119171, 6689.429612006905, 160.09016034457989],
            [580.5720323577907, -1444.8182353349043, 6667.6115052988225],
            [-1523.0562655578067, -6235.994352332637, -2408.6722984536445],
            [-159.743323427436, 3528.357106620524, -5895.102966680752],
            [1378.1198833334083, 5145.436781539436, 4321.002825847646],
            [-148.34346917990604, -5221.600122475786, 4425.187458290727],
            [-1180.4514123324327, -3406.527533492021, -5842.385406362396],
            [338.9626491493065, 6388.199018041551, -2510.2259806490365],
            [982.7093176168127, 1336.5066224728498, 6642.635079905863],
            [-445.9248110686201, -6835.808078514031, 221.1680616924222],
            [-828.6455146430822, 966.0791363273898, -6753.584306713813],
            [487.47999558044654, 6544.617932203937, 2004.4327747089353],
            [730.3590499648018, -3138.9862999378283, 6036.5345976049475],
            [-534.7030691024943, -5467.650004744615, -4116.379968715104],
            [-695.1284954916638, 4984.964050112834, -4680.430738925479],
            [603.287147471104, 3810.650836063182, 5657.720565798082],
            [676.4712500364693, -6265.2887066041585, 2687.7142139210496],
            [-747.7474840010815, -1661.5652916857762, -6626.684507277654],
        ]
    )
    expected_vs = np.array(
        [
            [-0.2073550646387298, -4.140722397852882, 6.391434915103069],
            [-0.2096985197227052, -4.147514435605311, 6.38696195708428],
            [-0.2120417168437132, -4.154301364166556, 6.3824811063454865],
            [-0.21438465310437, -4.161083175142957, 6.37799236843962],
            [-0.2167273256080704, -4.167859860148546, 6.373495748928588],
            [-0.2190697314582986, -4.174631410803029, 6.368991253384616],
            [-0.2214118677591449, -4.181397818733315, 6.364478887389197],
            [-0.2237537316148448, -4.188159075572147, 6.3599586565340465],
            [-0.2260953201303225, -4.194915172959697, 6.355430566420001],
            [-0.2284366304104022, -4.201666102541273, 6.350894622658565],
            [-0.230777659560845, -4.208411855970331, 6.346350830869909],
            [-0.2331184046876895, -4.215152424906547, 6.341799196684123],
            [-0.2354588628967786, -4.2218878010144705, 6.337239725742165],
            [-0.2377990312953039, -4.228617975967973, 6.332672423692828],
            [-0.2401389069902221, -4.235342941445674, 6.328097296195846],
            [-0.2424784870890095, -4.242062689133129, 6.323514348920403],
            [-0.2448177686996754, -4.248777210722855, 6.318923587545126],
            [-0.2471567489307131, -4.255486497914194, 6.314325017758162],
            [-0.2494954248906751, -4.262190542412103, 6.309718645258018],
            [-0.2518337936889068, -4.268889335929229, 6.305104475752124],
            [-0.2541718524351056, -4.275582870184684, 6.300482514957695],
            [-0.256509598239298, -4.282271136903951, 6.29585276860177],
            [-0.2588470282119419, -4.288954127819188, 6.291215242421014],
            [-0.2611841394640487, -4.295631834669566, 6.286569942161479],
            [-0.2635209291070231, -4.3023042492008265, 6.281916873578925],
            [-0.265857394252715, -4.30897136316542, 6.277256042438696],
            [-0.2681935320135406, -4.315633168322853, 6.272587454515494],
            [-0.2705293395020175, -4.322289656438352, 6.267911115594314],
            [-0.2728648138314709, -4.328940819284907, 6.2632270314690075],
            [-0.2751999521155856, -4.335586648641951, 6.2585352079432],
            [-0.2775347514684905, -4.342227136295636, 6.25383565083011],
            [-0.2798692090048668, -4.348862274039118, 6.249128365952336],
            [-0.2822033218396666, -4.355492053671778, 6.244413359142413],
            [-0.2845370870885757, -4.362116467000512, 6.239690636241896],
            [-0.2868705018675685, -4.3687355058384885, 6.234960203102241],
            [-0.2892035632930586, -4.375349162005552, 6.230222065584509],
            [-0.2915362684822215, -4.381957427329174, 6.225476229558707],
            [-0.293868614552574, -4.388560293643217, 6.220722700904647],
            [-0.2962005986219851, -4.395157752788007, 6.215961485511906],
            [-0.2985322178090071, -4.401749796611226, 6.211192589279184],
            [-0.3008634692327058, -4.408336416967473, 6.206416018114613],
            [-0.3031943500124629, -4.414917605717685, 6.201631777936185],
            [-0.3055248572683437, -4.421493354730167, 6.196839874670979],
            [-0.3078549881208841, -4.428063655880017, 6.192040314255626],
            [-0.3101847396911808, -4.4346285010493425, 6.18723310263609],
            [-0.3125141091007347, -4.441187882126871, 6.182418245768007],
            [-0.314843093471518, -4.447741791008075, 6.177595749616556],
            [-0.3171716899263782, -4.454290219596361, 6.172765620155591],
            [-0.3194998955882855, -4.460833159800929, 6.167927863369228],
            [-0.3218277075809772, -4.46737060353859, 6.163082485250503],
            [-0.3241551230287344, -4.473902542733123, 6.158229491801822],
            [-0.326482139056193, -4.480428969314776, 6.153368889035366],
            [-0.3288087527887225, -4.486949875221291, 6.148500682972296],
            [-0.3311349613521739, -4.493465252397231, 6.143624879643273],
            [-0.3334607618730176, -4.499975092794339, 6.138741485088183],
            [-0.3357861514780387, -4.506479388370698, 6.1338505053567625],
            [-0.3381111272950615, -4.512978131092746, 6.128951946507087],
            [-0.340435686451753, -4.519471312931965, 6.124045814608065],
            [-0.3427598260771864, -4.525958925869203, 6.119132115736172],
            [-0.3450835433003527, -4.532440961890534, 6.114210855978575],
            [-0.3474068352511085, -4.538917412989925, 6.109282041431131],
            [-0.4859179223569589, -4.916985557122564, 5.7999639312986195],
            [-0.6222730120575873, -5.273247502383786, 5.464858846089748],
            [-0.75586706932246, -5.6061228229650615, 5.105458587632392],
            [-0.8861079998771406, -5.914136629448147, 4.723361304896389],
            [-1.0124192096869649, -6.195925614885237, 4.32026393330377],
            [-1.1342420539667804, -6.4502435119306, 3.8979543258959164],
            [-1.2510381701383082, -6.675965967603209, 3.4583031309656986],
            [-1.3622916914520262, -6.872094848169788, 3.0032554649613568],
            [-1.4675113400082147, -7.037761991012112, 2.5348224227943206],
            [-1.5662323995641427, -7.172232423044094, 2.0550724605242365],
            [-1.6580185697550913, -7.274907066258617, 1.5661226780726738],
            [-1.7424637041349924, -7.345324950324131, 1.0701300225377668],
            [-1.8191934347406797, -7.383164949933702, 0.5692824261998276],
            [-1.8878666857061708, -7.38824706101544, 0.0657898877408968],
            [-1.9481770778193883, -7.360533225179964, -0.4381244991417098],
            [-1.9998542248694826, -7.300127706207726, -0.9402335684331059],
            [-2.042664921243011, -7.207277016305739, -1.4383151557770972],
            [-2.076414218573187, -7.082369383650207, -1.930161223251664],
            [-2.100946387418187, -6.925933746764095, -2.4135870322443296],
            [-2.1161457580545555, -6.738638255921973, -2.8864403578731332],
            [-2.121937432622076, -6.521288257385855, -3.3466107329862713],
            [-2.118287859161693, -6.274823733168899, -3.792038703061413],
            [0.9125441136971254, -0.4036263758191757, 7.5486308279435335],
            [-1.729961033875925, -7.290729001501352, -1.4355610853568541],
            [-0.3916201544601054, 2.8167811063026003, -7.077962466427237],
            [1.6184297618406134, 6.396734535484474, 3.778738245362283],
            [-0.0080292479855039, -4.915065455539146, 5.825540099474531],
            [-1.4265859438109267, -4.8322204640145925, -5.7379636127176274],
            [0.2897642770579129, 6.539276361815458, -3.8844862764055033],
            [1.1963932991763286, 2.6864347770586763, 7.0191019613676255],
            [-0.4455836541568785, -7.456656235390363, 1.5538057203626578],
            [-0.9975397122714986, -0.1946639775439141, -7.5638573644429385],
            [0.5217555136151566, 7.515999697547012, 1.0052803968671364],
            [0.8577574094931962, -2.294384083965723, 7.2175594450779],
            [-0.5657934399594602, -6.785902068629772, -3.4546071716871123],
            [-0.7819445998604514, 4.594586638449409, -6.023200662213964],
            [0.6211293067030208, 5.230422410669326, 5.486381546483309],
            [0.7622805619711007, -6.3441491290521, 4.171792905923215],
            [-0.7421348156995247, -3.078366902016442, -6.9456623617471385],
            [-0.7414507861435826, 7.355580423966695, -1.7666135107468575],
        ]
    )

    expected_rs = np.tile(np.array(expected_rs)[None, ...], (100, 1, 1))
    expected_vs = np.tile(np.array(expected_vs)[None, ...], (100, 1, 1))

    return tles, epochs, expected_rs, expected_vs


@pytest.fixture
def multiple_satellites_multiple_dates_data_large():
    tle = (
        "1 41557U 16033B   20345.20030338  .00003290  00000-0  12071-3 0  9996",
        "2 41557  97.3998  74.3002 0013100 179.2679 265.4184 15.28602096252616",
    )
    # TODO: Use different TLEs?
    tles = [tle] * 10_000
    epochs = (
        [dt.datetime(2020, 12, 11, 12, 0, minute) for minute in range(60)]
        + [dt.datetime(2020, 12, 11, 12, hour, 0) for hour in range(1, 24)]
        + [dt.datetime(2020, 12, day, 0, 0, 0) for day in range(13, 31)]
    ) * 100

    return tles, epochs, (len(tles), len(epochs), 3)
